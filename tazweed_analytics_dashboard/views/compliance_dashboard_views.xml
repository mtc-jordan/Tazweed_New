<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- ==================== Compliance Dashboard Views ==================== -->
    
    <!-- Dashboard Tree View -->
    <record id="view_compliance_dashboard_tree" model="ir.ui.view">
        <field name="name">compliance.analytics.dashboard.tree</field>
        <field name="model">compliance.analytics.dashboard</field>
        <field name="arch" type="xml">
            <tree string="Compliance Dashboards" decoration-danger="compliance_rate &lt; 80" decoration-warning="compliance_rate &lt; 95">
                <field name="name"/>
                <field name="date_from"/>
                <field name="date_to"/>
                <field name="total_documents"/>
                <field name="valid_documents"/>
                <field name="expired_documents"/>
                <field name="expiring_soon"/>
                <field name="compliance_rate" widget="percentage"/>
            </tree>
        </field>
    </record>
    
    <!-- Dashboard Form View -->
    <record id="view_compliance_dashboard_form" model="ir.ui.view">
        <field name="name">compliance.analytics.dashboard.form</field>
        <field name="model">compliance.analytics.dashboard</field>
        <field name="arch" type="xml">
            <form string="Compliance Dashboard">
                <header>
                    <button name="action_refresh" string="Refresh Data" type="object" class="btn-primary" icon="fa-refresh"/>
                    <button name="action_view_expired_documents" string="View Expired" type="object" class="btn-danger" icon="fa-exclamation-triangle"/>
                    <button name="action_view_expiring_documents" string="View Expiring Soon" type="object" class="btn-warning" icon="fa-clock-o"/>
                    <button name="action_send_expiry_alerts" string="Send Alerts" type="object" class="btn-secondary" icon="fa-envelope"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Dashboard Name"/>
                        </h1>
                    </div>
                    
                    <!-- Filters Section -->
                    <group string="Dashboard Filters" col="4">
                        <field name="date_from" widget="date"/>
                        <field name="date_to" widget="date"/>
                        <field name="view_type"/>
                        <field name="expiry_warning_days"/>
                    </group>
                    
                    <group string="Filter by" col="2">
                        <field name="department_ids" widget="many2many_tags"/>
                        <field name="document_type_ids" widget="many2many_tags"/>
                    </group>
                    
                    <notebook>
                        <page string="Dashboard Overview" name="overview">
                            <div class="container-fluid">
                                <h3 class="text-center mt-3 mb-4">
                                    <i class="fa fa-shield"/> Compliance Status
                                </h3>
                                
                                <!-- Main Compliance KPIs -->
                                <group col="5" class="mb-4">
                                    <div style="background: linear-gradient(135deg, #2196F3, #1976D2); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h4 style="color: white;"><i class="fa fa-file-text"/> Total Documents</h4>
                                        <h2 style="color: white; font-weight: bold;"><field name="total_documents"/></h2>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #4CAF50, #388E3C); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h4 style="color: white;"><i class="fa fa-check-circle"/> Valid</h4>
                                        <h2 style="color: white; font-weight: bold;"><field name="valid_documents"/></h2>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #F44336, #D32F2F); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h4 style="color: white;"><i class="fa fa-times-circle"/> Expired</h4>
                                        <h2 style="color: white; font-weight: bold;"><field name="expired_documents"/></h2>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #FF9800, #F57C00); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h4 style="color: white;"><i class="fa fa-clock-o"/> Expiring Soon</h4>
                                        <h2 style="color: white; font-weight: bold;"><field name="expiring_soon"/></h2>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #9C27B0, #7B1FA2); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h4 style="color: white;"><i class="fa fa-percent"/> Compliance Rate</h4>
                                        <h2 style="color: white; font-weight: bold;"><field name="compliance_rate"/>%</h2>
                                    </div>
                                </group>
                                
                                <!-- Document Type Breakdown -->
                                <h3 class="text-center mt-4 mb-3">
                                    <i class="fa fa-id-card"/> Document Status by Type
                                </h3>
                                
                                <group col="4" class="mb-4">
                                    <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #2196F3; margin: 5px;">
                                        <h5><i class="fa fa-plane text-primary"/> Visas</h5>
                                        <p class="text-success mb-0">Valid: <field name="visas_valid"/></p>
                                        <p class="text-danger mb-0">Expired: <field name="visas_expired"/></p>
                                    </div>
                                    <div style="background: #E8F5E9; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #4CAF50; margin: 5px;">
                                        <h5><i class="fa fa-id-badge text-success"/> Labor Cards</h5>
                                        <p class="text-success mb-0">Valid: <field name="labor_cards_valid"/></p>
                                        <p class="text-danger mb-0">Expired: <field name="labor_cards_expired"/></p>
                                    </div>
                                    <div style="background: #FFF3E0; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #FF9800; margin: 5px;">
                                        <h5><i class="fa fa-address-card text-warning"/> Emirates IDs</h5>
                                        <p class="text-success mb-0">Valid: <field name="emirates_ids_valid"/></p>
                                        <p class="text-danger mb-0">Expired: <field name="emirates_ids_expired"/></p>
                                    </div>
                                    <div style="background: #F3E5F5; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #9C27B0; margin: 5px;">
                                        <h5><i class="fa fa-medkit"/> Medical</h5>
                                        <p class="text-success mb-0">Valid: <field name="medical_valid"/></p>
                                        <p class="text-danger mb-0">Expired: <field name="medical_expired"/></p>
                                    </div>
                                </group>
                                
                                <!-- Work Permits -->
                                <h3 class="text-center mt-4 mb-3">
                                    <i class="fa fa-briefcase"/> Work Permits
                                </h3>
                                
                                <group col="3" class="mb-4">
                                    <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>Total Work Permits</h5>
                                        <h3 class="text-primary"><field name="total_work_permits"/></h3>
                                    </div>
                                    <div style="background: #E8F5E9; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>Active</h5>
                                        <h3 class="text-success"><field name="active_work_permits"/></h3>
                                    </div>
                                    <div style="background: #FFEBEE; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>Expired</h5>
                                        <h3 class="text-danger"><field name="expired_work_permits"/></h3>
                                    </div>
                                </group>
                                
                                <!-- Emiratization -->
                                <h3 class="text-center mt-4 mb-3">
                                    <i class="fa fa-flag"/> Emiratization Compliance
                                </h3>
                                
                                <group col="3" class="mb-4">
                                    <div style="background: #E8F5E9; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>Target %</h5>
                                        <h3 class="text-success"><field name="emiratization_target"/>%</h3>
                                    </div>
                                    <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>Actual %</h5>
                                        <h3 class="text-primary"><field name="emiratization_actual"/>%</h3>
                                    </div>
                                    <div style="background: #FFF3E0; padding: 15px; border-radius: 8px; text-align: center; margin: 5px;">
                                        <h5>UAE Nationals</h5>
                                        <h3 class="text-warning"><field name="uae_nationals_count"/></h3>
                                    </div>
                                </group>
                            </div>
                        </page>
                        
                        <page string="Detailed Data" name="data">
                            <group string="Dashboard JSON Data">
                                <field name="dashboard_data" widget="text" readonly="1" nolabel="1"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- Dashboard Action -->
    <record id="action_compliance_dashboard" model="ir.actions.act_window">
        <field name="name">Compliance Dashboard</field>
        <field name="res_model">compliance.analytics.dashboard</field>
        <field name="view_mode">form,tree</field>
        <field name="context">{'default_name': 'Compliance Analytics'}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first Compliance Dashboard
            </p>
            <p>
                Track document compliance, work permits, and emiratization metrics.
            </p>
        </field>
    </record>
    
</odoo>
