<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Payroll Security Groups -->
    <record id="group_payroll_user" model="res.groups">
        <field name="name">Payroll User</field>
        <field name="category_id" ref="tazweed_core.module_category_tazweed"/>
        <field name="implied_ids" eval="[(4, ref('tazweed_core.group_tazweed_user'))]"/>
    </record>

    <record id="group_payroll_officer" model="res.groups">
        <field name="name">Payroll Officer</field>
        <field name="category_id" ref="tazweed_core.module_category_tazweed"/>
        <field name="implied_ids" eval="[(4, ref('group_payroll_user'))]"/>
    </record>

    <record id="group_payroll_manager" model="res.groups">
        <field name="name">Payroll Manager</field>
        <field name="category_id" ref="tazweed_core.module_category_tazweed"/>
        <field name="implied_ids" eval="[(4, ref('group_payroll_officer'))]"/>
    </record>

    <record id="group_payroll_admin" model="res.groups">
        <field name="name">Payroll Administrator</field>
        <field name="category_id" ref="tazweed_core.module_category_tazweed"/>
        <field name="implied_ids" eval="[(4, ref('group_payroll_manager'))]"/>
    </record>

    <!-- Record Rules -->
    <!-- Payslip: Users see own department, Officers see all -->
    <record id="rule_payslip_user" model="ir.rule">
        <field name="name">Payslip: User Department</field>
        <field name="model_id" ref="model_hr_payslip"/>
        <field name="domain_force">[('employee_id.department_id.manager_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_user'))]"/>
    </record>

    <record id="rule_payslip_officer" model="ir.rule">
        <field name="name">Payslip: Officer All</field>
        <field name="model_id" ref="model_hr_payslip"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_officer'))]"/>
    </record>

    <!-- Loan: Users see own, Officers see all -->
    <record id="rule_loan_user" model="ir.rule">
        <field name="name">Loan: User Own</field>
        <field name="model_id" ref="model_tazweed_payroll_loan"/>
        <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_user'))]"/>
    </record>

    <record id="rule_loan_officer" model="ir.rule">
        <field name="name">Loan: Officer All</field>
        <field name="model_id" ref="model_tazweed_payroll_loan"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_officer'))]"/>
    </record>

    <!-- WPS: Officers and above -->
    <record id="rule_wps_officer" model="ir.rule">
        <field name="name">WPS: Officer Access</field>
        <field name="model_id" ref="model_tazweed_wps_file"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_officer'))]"/>
    </record>

    <!-- Gratuity: Officers and above -->
    <record id="rule_gratuity_officer" model="ir.rule">
        <field name="name">Gratuity: Officer Access</field>
        <field name="model_id" ref="model_tazweed_employee_gratuity"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_payroll_officer'))]"/>
    </record>
</odoo>
