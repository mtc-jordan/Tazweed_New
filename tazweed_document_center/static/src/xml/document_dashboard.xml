<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="tazweed_document_center.DocumentCenterDashboard" owl="1">
        <div class="o_document_center_dashboard">
            <!-- Loading State -->
            <div t-if="state.loading" class="text-center py-5">
                <i class="fa fa-spinner fa-spin fa-3x text-primary"></i>
                <p class="mt-3 text-muted">Loading document center...</p>
            </div>

            <div t-else="" class="container-fluid py-4">
                <!-- Header -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2 class="mb-1">
                                    <i class="fa fa-folder-open text-primary me-2"></i>
                                    Document Center
                                </h2>
                                <p class="text-muted mb-0">Central hub for all HR documents across modules</p>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-primary" t-on-click="onSyncDocuments">
                                    <i class="fa fa-refresh me-1"></i> Sync Documents
                                </button>
                                <button class="btn btn-primary" t-on-click="onUploadDocument">
                                    <i class="fa fa-upload me-1"></i> Upload Document
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alerts -->
                <div t-if="state.alerts.length > 0" class="row mb-4">
                    <div class="col-12">
                        <t t-foreach="state.alerts" t-as="alert" t-key="alert_index">
                            <div t-attf-class="alert alert-#{alert.type} d-flex align-items-center" role="alert">
                                <i t-attf-class="fa #{alert.icon} me-2"></i>
                                <span t-esc="alert.message"/>
                            </div>
                        </t>
                    </div>
                </div>

                <!-- KPI Cards -->
                <div class="row mb-4">
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm cursor-pointer" t-on-click="onViewAllDocuments">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6 class="text-muted mb-2">Total Documents</h6>
                                        <h2 class="mb-0 text-primary" t-esc="state.stats.totalDocuments"/>
                                    </div>
                                    <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                                        <i class="fa fa-files-o fa-lg text-primary"></i>
                                    </div>
                                </div>
                                <small class="text-muted">All documents in system</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm cursor-pointer" t-on-click="onViewExpired">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6 class="text-muted mb-2">Expired</h6>
                                        <h2 class="mb-0 text-danger" t-esc="state.stats.expiredDocuments"/>
                                    </div>
                                    <div class="rounded-circle bg-danger bg-opacity-10 p-3">
                                        <i class="fa fa-exclamation-circle fa-lg text-danger"></i>
                                    </div>
                                </div>
                                <small class="text-danger">Requires immediate attention</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm cursor-pointer" t-on-click="onViewExpiring">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6 class="text-muted mb-2">Expiring Soon</h6>
                                        <h2 class="mb-0 text-warning" t-esc="state.stats.expiringDocuments"/>
                                    </div>
                                    <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                                        <i class="fa fa-clock-o fa-lg text-warning"></i>
                                    </div>
                                </div>
                                <small class="text-muted">Within next 30 days</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm cursor-pointer" t-on-click="onViewValid">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6 class="text-muted mb-2">Valid</h6>
                                        <h2 class="mb-0 text-success" t-esc="state.stats.validDocuments"/>
                                    </div>
                                    <div class="rounded-circle bg-success bg-opacity-10 p-3">
                                        <i class="fa fa-check-circle fa-lg text-success"></i>
                                    </div>
                                </div>
                                <small class="text-success">Up to date documents</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Secondary Stats -->
                <div class="row mb-4">
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h6 class="text-muted mb-2">Compliance Rate</h6>
                                <h3 class="mb-0">
                                    <span t-esc="state.stats.complianceRate"/>%
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h6 class="text-muted mb-2">Verified</h6>
                                <h3 class="mb-0 text-info" t-esc="state.stats.verifiedDocuments"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h6 class="text-muted mb-2">Expiring in 7 Days</h6>
                                <h3 class="mb-0 text-danger" t-esc="state.stats.expiring7Days"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h6 class="text-muted mb-2">Expiring in 30 Days</h6>
                                <h3 class="mb-0 text-warning" t-esc="state.stats.expiring30Days"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0">
                                <h6 class="mb-0">
                                    <i class="fa fa-pie-chart text-primary me-2"></i>
                                    Documents by Category
                                </h6>
                            </div>
                            <div class="card-body">
                                <div style="height: 250px;">
                                    <canvas id="categoryChart" t-ref="categoryChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0">
                                <h6 class="mb-0">
                                    <i class="fa fa-database text-primary me-2"></i>
                                    Documents by Source Module
                                </h6>
                            </div>
                            <div class="card-body">
                                <div style="height: 250px;">
                                    <canvas id="sourceChart" t-ref="sourceChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0">
                                <h6 class="mb-0">
                                    <i class="fa fa-bar-chart text-primary me-2"></i>
                                    Expiry Timeline
                                </h6>
                            </div>
                            <div class="card-body">
                                <div style="height: 250px;">
                                    <canvas id="expiryChart" t-ref="expiryChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0">
                                <h6 class="mb-0">
                                    <i class="fa fa-building text-primary me-2"></i>
                                    Documents by Department
                                </h6>
                            </div>
                            <div class="card-body">
                                <div style="height: 250px;">
                                    <canvas id="departmentChart" t-ref="departmentChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tables Row -->
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center">
                                <h6 class="mb-0">
                                    <i class="fa fa-warning text-warning me-2"></i>
                                    Expiring Soon
                                </h6>
                                <button class="btn btn-sm btn-outline-primary" t-on-click="onViewExpiring">View All</button>
                            </div>
                            <div class="card-body p-0">
                                <t t-if="state.expiringSoon.length === 0">
                                    <div class="text-center py-4 text-muted">
                                        <i class="fa fa-check-circle fa-2x mb-2"></i>
                                        <p>No documents expiring soon</p>
                                    </div>
                                </t>
                                <t t-else="">
                                    <table class="table table-hover mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Document</th>
                                                <th>Employee</th>
                                                <th>Expiry Date</th>
                                                <th>Days Left</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="state.expiringSoon" t-as="doc" t-key="doc.id">
                                                <tr class="cursor-pointer" t-on-click="() => this.onViewDocument(doc.id)">
                                                    <td t-esc="doc.name"/>
                                                    <td t-esc="doc.employee"/>
                                                    <td t-esc="formatDate(doc.expiry_date)"/>
                                                    <td>
                                                        <span t-attf-class="badge #{getDaysLeftClass(doc.days_left) === 'text-danger' ? 'bg-danger' : getDaysLeftClass(doc.days_left) === 'text-warning' ? 'bg-warning' : 'bg-success'}">
                                                            <t t-esc="doc.days_left"/> days
                                                        </span>
                                                    </td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center">
                                <h6 class="mb-0">
                                    <i class="fa fa-clock-o text-primary me-2"></i>
                                    Recent Documents
                                </h6>
                                <button class="btn btn-sm btn-outline-primary" t-on-click="onViewAllDocuments">View All</button>
                            </div>
                            <div class="card-body p-0">
                                <t t-if="state.recentDocuments.length === 0">
                                    <div class="text-center py-4 text-muted">
                                        <i class="fa fa-folder-open-o fa-2x mb-2"></i>
                                        <p>No documents yet</p>
                                    </div>
                                </t>
                                <t t-else="">
                                    <table class="table table-hover mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Document</th>
                                                <th>Category</th>
                                                <th>Source</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="state.recentDocuments" t-as="doc" t-key="doc.id">
                                                <tr class="cursor-pointer" t-on-click="() => this.onViewDocument(doc.id)">
                                                    <td t-esc="doc.name"/>
                                                    <td t-esc="doc.category"/>
                                                    <td>
                                                        <span class="badge bg-secondary" t-esc="doc.source"/>
                                                    </td>
                                                    <td>
                                                        <span t-attf-class="badge #{getStatusClass(doc.state)}" t-esc="getStatusLabel(doc.state)"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>
