<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Performance Module Category -->
    <record id="module_category_performance" model="ir.module.category">
        <field name="name">Performance Management</field>
        <field name="description">Performance management and reviews</field>
        <field name="sequence">25</field>
    </record>

    <!-- Security Groups -->
    <record id="group_performance_user" model="res.groups">
        <field name="name">Performance User</field>
        <field name="category_id" ref="module_category_performance"/>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
    </record>

    <record id="group_performance_manager" model="res.groups">
        <field name="name">Performance Manager</field>
        <field name="category_id" ref="module_category_performance"/>
        <field name="implied_ids" eval="[(4, ref('group_performance_user'))]"/>
    </record>

    <record id="group_performance_admin" model="res.groups">
        <field name="name">Performance Administrator</field>
        <field name="category_id" ref="module_category_performance"/>
        <field name="implied_ids" eval="[(4, ref('group_performance_manager'))]"/>
    </record>

    <!-- Record Rules -->
    <!-- Performance Review - Users see own reviews -->
    <record id="rule_performance_review_user" model="ir.rule">
        <field name="name">Performance Review: User sees own</field>
        <field name="model_id" ref="model_tazweed_performance_review"/>
        <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Performance Review - Managers see team reviews -->
    <record id="rule_performance_review_manager" model="ir.rule">
        <field name="name">Performance Review: Manager sees team</field>
        <field name="model_id" ref="model_tazweed_performance_review"/>
        <field name="domain_force">['|', ('employee_id.user_id', '=', user.id), ('manager_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Goals - Users see own goals -->
    <record id="rule_performance_goal_user" model="ir.rule">
        <field name="name">Performance Goal: User sees own</field>
        <field name="model_id" ref="model_tazweed_performance_goal"/>
        <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Goals - Managers see team goals -->
    <record id="rule_performance_goal_manager" model="ir.rule">
        <field name="name">Performance Goal: Manager sees team</field>
        <field name="model_id" ref="model_tazweed_performance_goal"/>
        <field name="domain_force">['|', ('employee_id.user_id', '=', user.id), ('manager_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <!-- Development Plan - Users see own plans -->
    <record id="rule_development_plan_user" model="ir.rule">
        <field name="name">Development Plan: User sees own</field>
        <field name="model_id" ref="model_tazweed_development_plan"/>
        <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Feedback - Users see feedback about them -->
    <record id="rule_feedback_user" model="ir.rule">
        <field name="name">Feedback: User sees own feedback</field>
        <field name="model_id" ref="model_tazweed_performance_feedback"/>
        <field name="domain_force">['|', ('employee_id.user_id', '=', user.id), ('provider_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_performance_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Administrator Rules - Full Access -->
    <record id="rule_performance_review_admin" model="ir.rule">
        <field name="name">Performance Review: Admin full access</field>
        <field name="model_id" ref="model_tazweed_performance_review"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_performance_admin'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <record id="rule_performance_goal_admin" model="ir.rule">
        <field name="name">Performance Goal: Admin full access</field>
        <field name="model_id" ref="model_tazweed_performance_goal"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_performance_admin'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <record id="rule_development_plan_admin" model="ir.rule">
        <field name="name">Development Plan: Admin full access</field>
        <field name="model_id" ref="model_tazweed_development_plan"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_performance_admin'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <record id="rule_feedback_admin" model="ir.rule">
        <field name="name">Feedback: Admin full access</field>
        <field name="model_id" ref="model_tazweed_performance_feedback"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_performance_admin'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
</odoo>
