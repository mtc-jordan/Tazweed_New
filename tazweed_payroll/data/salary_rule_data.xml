<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- Basic Salary Rule -->
        <record id="rule_basic" model="hr.salary.rule">
            <field name="name">Basic Salary</field>
            <field name="code">BASIC</field>
            <field name="sequence">1</field>
            <field name="category_id" ref="category_basic"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.wage</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">basic</field>
            <field name="gratuity_include">True</field>
        </record>

        <!-- Housing Allowance Rule -->
        <record id="rule_housing" model="hr.salary.rule">
            <field name="name">Housing Allowance</field>
            <field name="code">HRA</field>
            <field name="sequence">10</field>
            <field name="category_id" ref="category_housing"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.housing_allowance > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.housing_allowance</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">housing</field>
            <field name="gratuity_include">False</field>
        </record>

        <!-- Transport Allowance Rule -->
        <record id="rule_transport" model="hr.salary.rule">
            <field name="name">Transport Allowance</field>
            <field name="code">TRA</field>
            <field name="sequence">11</field>
            <field name="category_id" ref="category_transport"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.transport_allowance > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.transport_allowance</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">transport</field>
            <field name="gratuity_include">False</field>
        </record>

        <!-- Other Allowances Rule -->
        <record id="rule_other_allowance" model="hr.salary.rule">
            <field name="name">Other Allowances</field>
            <field name="code">OTH_ALW</field>
            <field name="sequence">15</field>
            <field name="category_id" ref="category_allowance"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.other_allowance > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.other_allowance</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">other_allowance</field>
        </record>

        <!-- Overtime Rule -->
        <record id="rule_overtime" model="hr.salary.rule">
            <field name="name">Overtime</field>
            <field name="code">OT</field>
            <field name="sequence">20</field>
            <field name="category_id" ref="category_overtime"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.get('OT_HOURS', 0) > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
# Overtime calculation: Basic/30/8 * 1.25 * hours
hourly_rate = contract.wage / 30 / 8
overtime_rate = 1.25  # 125% as per UAE law
overtime_hours = inputs.get('OT_HOURS', 0)
result = hourly_rate * overtime_rate * overtime_hours
            </field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">overtime</field>
        </record>

        <!-- Commission Rule -->
        <record id="rule_commission" model="hr.salary.rule">
            <field name="name">Commission</field>
            <field name="code">COMM</field>
            <field name="sequence">25</field>
            <field name="category_id" ref="category_commission"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.get('COMMISSION', 0) > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.get('COMMISSION', 0)</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">commission</field>
        </record>

        <!-- Bonus Rule -->
        <record id="rule_bonus" model="hr.salary.rule">
            <field name="name">Bonus</field>
            <field name="code">BONUS</field>
            <field name="sequence">26</field>
            <field name="category_id" ref="category_allowance"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.get('BONUS', 0) > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.get('BONUS', 0)</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">other_allowance</field>
        </record>

        <!-- Gross Salary Rule -->
        <record id="rule_gross" model="hr.salary.rule">
            <field name="name">Gross Salary</field>
            <field name="code">GROSS</field>
            <field name="sequence">50</field>
            <field name="category_id" ref="category_gross"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = categories.get('BASIC', 0) + categories.get('ALW', 0) + categories.get('OT', 0) + categories.get('COMM', 0)
            </field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">False</field>
        </record>

        <!-- Loan Deduction Rule -->
        <record id="rule_loan" model="hr.salary.rule">
            <field name="name">Loan Deduction</field>
            <field name="code">LOAN_DED</field>
            <field name="sequence">60</field>
            <field name="category_id" ref="category_loan"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = payslip.loan_deduction > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = -payslip.loan_deduction</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">deduction</field>
        </record>

        <!-- Absence Deduction Rule -->
        <record id="rule_absence" model="hr.salary.rule">
            <field name="name">Absence Deduction</field>
            <field name="code">ABS_DED</field>
            <field name="sequence">61</field>
            <field name="category_id" ref="category_absence"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.get('ABSENCE', 0) > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
daily_wage = contract.wage / 30
absence_days = inputs.get('ABSENCE', 0)
result = -daily_wage * absence_days
            </field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">deduction</field>
        </record>

        <!-- Other Deduction Rule -->
        <record id="rule_other_deduction" model="hr.salary.rule">
            <field name="name">Other Deductions</field>
            <field name="code">OTH_DED</field>
            <field name="sequence">65</field>
            <field name="category_id" ref="category_deduction"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.get('OTHER_DED', 0) > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = -inputs.get('OTHER_DED', 0)</field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">True</field>
            <field name="wps_category">deduction</field>
        </record>

        <!-- Net Salary Rule -->
        <record id="rule_net" model="hr.salary.rule">
            <field name="name">Net Salary</field>
            <field name="code">NET</field>
            <field name="sequence">100</field>
            <field name="category_id" ref="category_net"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = categories.get('GROSS', 0) + categories.get('DED', 0)
            </field>
            <field name="appears_on_payslip">True</field>
            <field name="wps_include">False</field>
        </record>

        <!-- Gratuity Provision Rule (Employer Cost) -->
        <record id="rule_gratuity_provision" model="hr.salary.rule">
            <field name="name">Gratuity Provision</field>
            <field name="code">GRAT_PROV</field>
            <field name="sequence">110</field>
            <field name="category_id" ref="category_gratuity"/>
            <field name="struct_id" ref="structure_uae_employee"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
# Monthly gratuity provision: Basic/30 * 21/12 (21 days per year)
daily_wage = contract.wage / 30
monthly_provision = daily_wage * 21 / 12
result = monthly_provision
            </field>
            <field name="appears_on_payslip">False</field>
            <field name="wps_include">False</field>
        </record>
    </data>
</odoo>
