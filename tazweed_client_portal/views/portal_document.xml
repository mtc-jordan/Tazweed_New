<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Documents List Template -->
    <template id="portal_documents" name="My Documents">
        <t t-call="portal.portal_layout">
            <div class="portal-page">
                <div class="portal-header mb-4">
                    <h2>Documents</h2>
                    <p class="text-muted">Access shared documents, contracts, and reports</p>
                </div>

                <!-- Category Filter -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="btn-group flex-wrap" role="group">
                            <a href="/my/documents" t-attf-class="btn btn-outline-secondary #{not current_category and 'active' or ''}">
                                All
                            </a>
                            <t t-foreach="categories" t-as="cat">
                                <a t-attf-href="/my/documents?category=#{cat[0]}"
                                   t-attf-class="btn btn-outline-secondary #{current_category == cat[0] and 'active' or ''}">
                                    <t t-esc="cat[1]"/>
                                </a>
                            </t>
                        </div>
                    </div>
                </div>

                <!-- Documents Grid -->
                <t t-if="documents">
                    <div class="row">
                        <t t-foreach="documents" t-as="doc">
                            <div class="col-md-4 col-lg-3 mb-4">
                                <div class="portal-document-card h-100">
                                    <div class="portal-document-icon">
                                        <t t-if="doc.file_type == 'pdf'">
                                            <i class="fa fa-file-pdf" style="color: #F44336;"></i>
                                        </t>
                                        <t t-elif="doc.file_type in ['doc', 'docx']">
                                            <i class="fa fa-file-word" style="color: #2196F3;"></i>
                                        </t>
                                        <t t-elif="doc.file_type in ['xls', 'xlsx']">
                                            <i class="fa fa-file-excel" style="color: #4CAF50;"></i>
                                        </t>
                                        <t t-elif="doc.file_type in ['jpg', 'jpeg', 'png', 'gif']">
                                            <i class="fa fa-file-image" style="color: #9C27B0;"></i>
                                        </t>
                                        <t t-else="">
                                            <i class="fa fa-file" style="color: #607D8B;"></i>
                                        </t>
                                    </div>
                                    <div class="portal-document-name" title="{doc.name}">
                                        <t t-esc="doc.name[:30]"/>
                                        <t t-if="len(doc.name) > 30">...</t>
                                    </div>
                                    <div class="portal-document-meta">
                                        <t t-esc="doc.file_size_display"/>
                                        <br/>
                                        <small><t t-esc="doc.create_date.strftime('%b %d, %Y')"/></small>
                                    </div>
                                    <div class="mt-3">
                                        <t t-if="doc.requires_acknowledgment and not doc.is_acknowledged">
                                            <button onclick="TazweedPortal.acknowledgeDocument({doc.id})" 
                                                    class="btn btn-warning btn-sm btn-block mb-2">
                                                <i class="fa fa-check"></i> Acknowledge
                                            </button>
                                        </t>
                                        <a t-attf-href="/my/documents/#{doc.id}/download" class="btn btn-outline-primary btn-sm btn-block">
                                            <i class="fa fa-download"></i> Download
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </div>
                    <div class="d-flex justify-content-center mt-4">
                        <t t-call="portal.pager"/>
                    </div>
                </t>
                <t t-else="">
                    <t t-call="tazweed_client_portal.portal_empty_state">
                        <t t-set="icon">fa-folder-open</t>
                        <t t-set="title">No Documents</t>
                        <t t-set="message">No documents have been shared with you yet.</t>
                    </t>
                </t>
            </div>
        </t>
    </template>
</odoo>
